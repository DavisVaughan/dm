<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Test if the relation between two tables of a data model meet the requirements — check_cardinality • dm</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Test if the relation between two tables of a data model meet the requirements — check_cardinality" />
<meta property="og:description" content="All check_cardinality() functions test, if the pk_column is a unique key for parent_table and if
the set of values of fk_column of child_table is a subset of the set of values of pk_column.
Furthermore the cardinality of the relation is tested, see below for details." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dm</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/dm.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/dm-class-and-basic-operations.html">Class 'dm' and basic operations</a>
    </li>
    <li>
      <a href="../articles/dm-visualization.html">Visualizing 'dm' objects</a>
    </li>
    <li>
      <a href="../articles/dm-low-level.html">Low level operations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/krlmlr/dm">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Test if the relation between two tables of a data model meet the requirements</h1>
    
    <div class="hidden name"><code>check_cardinality.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>All <code>check_cardinality()</code> functions test, if the <code>pk_column</code> is a unique key for <code>parent_table</code> and if
the set of values of <code>fk_column</code> of <code>child_table</code> is a subset of the set of values of <code>pk_column</code>.
Furthermore the cardinality of the relation is tested, see below for details.</p>
    </div>

    <pre class="usage"><span class='fu'>check_cardinality_0_n</span>(<span class='no'>parent_table</span>, <span class='no'>pk_column</span>, <span class='no'>child_table</span>, <span class='no'>fk_column</span>)

<span class='fu'>check_cardinality_1_n</span>(<span class='no'>parent_table</span>, <span class='no'>pk_column</span>, <span class='no'>child_table</span>, <span class='no'>fk_column</span>)

<span class='fu'>check_cardinality_1_1</span>(<span class='no'>parent_table</span>, <span class='no'>pk_column</span>, <span class='no'>child_table</span>, <span class='no'>fk_column</span>)

<span class='fu'>check_cardinality_0_1</span>(<span class='no'>parent_table</span>, <span class='no'>pk_column</span>, <span class='no'>child_table</span>, <span class='no'>fk_column</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>parent_table</th>
      <td><p>Data frame</p></td>
    </tr>
    <tr>
      <th>pk_column</th>
      <td><p>Column of <code>parent_table</code> that has to be one of its unique keys.</p></td>
    </tr>
    <tr>
      <th>child_table</th>
      <td><p>Data frame</p></td>
    </tr>
    <tr>
      <th>fk_column</th>
      <td><p>Column of <code>child_table</code> that has to be a foreign key to <code>pk_column</code> in <code>parent_table</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>All <code>check_cardinality</code> functions accept a <code>parent table</code> (data frame), a column name of this table,
a <code>child table</code>, and a column name of the child table. The given column of the <code>parent table</code> has to be one of its
unique keys (no duplicates allowed).
Furthermore, in all cases, the set of values of the child table's column has to be a subset of the set of values of
the parent table's column.</p>
<p>The cardinality specifications <code>0_n</code>, <code>1_n</code>, <code>0_1</code>, <code>1_1</code> refer to the expected relation that the child table has with the parent table.
The numbers <code>0</code>, <code>1</code> and <code>n</code> refer to the number of values in the child table's column that correspond to each value of the
parent table's column. <code>n</code> means more than one in this context, with no upper limit.</p>
<p><code>0_n</code> means, that for each value of the <code>pk_column</code>, minimally <code>0</code> and maximally
<code>n</code> values have to correspond to it in the child table's column (which translates to no further restriction).</p>
<p><code>1_n</code> means, that for each value of the <code>pk_column</code>, minimally <code>1</code> and maximally
<code>n</code> values have to correspond to it in the child table's column. This means that there is a "surjective" relation from the child table
to the parent table w.r.t. the specified columns, i.e. for each parent table column value there exists at least one equal child table column value.</p>
<p><code>0_1</code> means, that for each value of the <code>pk_column</code>, minimally <code>0</code> and maximally
<code>1</code> value has to correspond to it in the child table's column. This means that there is a "injective" relation from the child table
to the parent table w.r.t. the specified columns, i.e. no parent table column value is addressed multiple times. But not all of the parent table
column values have to be referred to.</p>
<p><code>1_1</code> means, that for each value of the <code>pk_column</code>, precisely
<code>1</code> value has to correspond to it in the child table's column. This means that there is a "bijective" ("injective" AND "surjective") relation
between the child table and the parent table w.r.t. the specified columns, i.e. the sets of values of the two columns are equal and
there are no duplicates in either of them.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>d1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>tibble</span><span class='kw ns'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span>(<span class='kw'>a</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>5</span>)
<span class='no'>d2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>tibble</span><span class='kw ns'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span>(<span class='kw'>c</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>:<span class='fl'>5</span>, <span class='fl'>5</span>))
<span class='no'>d3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>tibble</span><span class='kw ns'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span>(<span class='kw'>c</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>4</span>)
<span class='co'># This does not pass, `c` is not unique key of d2:</span>
<span class='fu'><a href='https://rdrr.io/r/base/try.html'>try</a></span>(<span class='fu'>check_cardinality_0_n</span>(<span class='no'>d2</span>, <span class='no'>c</span>, <span class='no'>d1</span>, <span class='no'>a</span>))</div><div class='output co'>#&gt; Error : `c` not a unique key of `d2`.
#&gt; Backtrace:
#&gt;      █
#&gt;   1. ├─base::tryCatch(...)
#&gt;   2. │ └─base:::tryCatchList(expr, classes, parentenv, handlers)
#&gt;   3. │   ├─base:::tryCatchOne(...)
#&gt;   4. │   │ └─base:::doTryCatch(return(expr), name, parentenv, handler)
#&gt;   5. │   └─base:::tryCatchList(expr, names[-nh], parentenv, handlers[-nh])
#&gt;   6. │     └─base:::tryCatchOne(expr, names, parentenv, handlers[[1L]])
#&gt;   7. │       └─base:::doTryCatch(return(expr), name, parentenv, handler)
#&gt;   8. ├─base::withCallingHandlers(...)
#&gt;   9. ├─base::saveRDS(...)
#&gt;  10. ├─base::do.call(...)
#&gt;  11. ├─(function (what, args, quote = FALSE, envir = parent.frame()) ...
#&gt;  12. └─(function (..., crayon_enabled, crayon_colors, pkgdown_internet) ...
#&gt;  13.   └─pkgdown::build_site(...)
#&gt;  14.     └─pkgdown:::build_site_local(...)
#&gt;  15.       └─pkgdown::build_reference(...)
#&gt;  16.         └─purrr::map(...)
#&gt;  17.           └─pkgdown:::.f(.x[[i]], ...)
#&gt;  18.             └─pkgdown:::data_reference_topic(...)
#&gt;  19.               └─pkgdown:::run_examples(...)
#&gt;  20.                 └─pkgdown:::highlight_examples(code, topic, env = env)
#&gt;  21.                   └─evaluate::evaluate(x, child_env(env), new_device = TRUE)
#&gt;  22.                     └─evaluate:::evaluate_call(...)
#&gt;  23.                       ├─evaluate:::timing_fn(...)
#&gt;  24.                       ├─evaluate:::handle(...)
#&gt;  25.                       │ └─base::try(f, silent = TRUE)
#&gt;  26.                       │   └─base::tryCatch(...)
#&gt;  27.                       │     └─base:::tryCatchList(expr, classes, parentenv, handlers)
#&gt;  28.                       │       └─base:::tryCatchOne(expr, names, parentenv, handlers[[1L]])
#&gt;  29.                       │         └─base:::doTryCatch(return(expr), name, parentenv, handler)
#&gt;  30.                       ├─base::withCallingHandlers(...)
#&gt;  31.                       ├─base::withVisible(eval(expr, envir, enclos))
#&gt;  32.                       └─base::eval(expr, envir, enclos)
#&gt;  33.                         └─base::eval(expr, envir, enclos)
#&gt;  34.                           ├─base::try(check_cardinality_0_n(d2, c, d1, a))
#&gt;  35.                           │ └─base::tryCatch(...)
#&gt;  36.                           │   └─base:::tryCatchList(expr, classes, parentenv, handlers)
#&gt;  37.                           │     └─base:::tryCatchOne(expr, names, parentenv, handlers[[1L]])
#&gt;  38.                           │       └─base:::doTryCatch(return(expr), name, parentenv, handler)
#&gt;  39.                           └─dm::check_cardinality_0_n(d2, c, d1, a)
#&gt;  40.                             └─dm::check_key(!!pt, !!pkc)
#&gt;  41.                               └─dm:::abort_not_unique_key(as_label(data_q), map_chr(args, as_label))</div><div class='input'>
<span class='co'># This passes, multiple values in d2$c are allowed:</span>
<span class='fu'>check_cardinality_0_n</span>(<span class='no'>d1</span>, <span class='no'>a</span>, <span class='no'>d2</span>, <span class='no'>c</span>)

<span class='co'># This does not pass, injectivity is violated:</span>
<span class='fu'><a href='https://rdrr.io/r/base/try.html'>try</a></span>(<span class='fu'>check_cardinality_1_1</span>(<span class='no'>d1</span>, <span class='no'>a</span>, <span class='no'>d2</span>, <span class='no'>c</span>))</div><div class='output co'>#&gt; Error : 1..1 cardinality (bijectivity) is not given: Column `c` in table `d2` contains duplicate values.
#&gt; Backtrace:
#&gt;      █
#&gt;   1. ├─base::tryCatch(...)
#&gt;   2. │ └─base:::tryCatchList(expr, classes, parentenv, handlers)
#&gt;   3. │   ├─base:::tryCatchOne(...)
#&gt;   4. │   │ └─base:::doTryCatch(return(expr), name, parentenv, handler)
#&gt;   5. │   └─base:::tryCatchList(expr, names[-nh], parentenv, handlers[-nh])
#&gt;   6. │     └─base:::tryCatchOne(expr, names, parentenv, handlers[[1L]])
#&gt;   7. │       └─base:::doTryCatch(return(expr), name, parentenv, handler)
#&gt;   8. ├─base::withCallingHandlers(...)
#&gt;   9. ├─base::saveRDS(...)
#&gt;  10. ├─base::do.call(...)
#&gt;  11. ├─(function (what, args, quote = FALSE, envir = parent.frame()) ...
#&gt;  12. └─(function (..., crayon_enabled, crayon_colors, pkgdown_internet) ...
#&gt;  13.   └─pkgdown::build_site(...)
#&gt;  14.     └─pkgdown:::build_site_local(...)
#&gt;  15.       └─pkgdown::build_reference(...)
#&gt;  16.         └─purrr::map(...)
#&gt;  17.           └─pkgdown:::.f(.x[[i]], ...)
#&gt;  18.             └─pkgdown:::data_reference_topic(...)
#&gt;  19.               └─pkgdown:::run_examples(...)
#&gt;  20.                 └─pkgdown:::highlight_examples(code, topic, env = env)
#&gt;  21.                   └─evaluate::evaluate(x, child_env(env), new_device = TRUE)
#&gt;  22.                     └─evaluate:::evaluate_call(...)
#&gt;  23.                       ├─evaluate:::timing_fn(...)
#&gt;  24.                       ├─evaluate:::handle(...)
#&gt;  25.                       │ └─base::try(f, silent = TRUE)
#&gt;  26.                       │   └─base::tryCatch(...)
#&gt;  27.                       │     └─base:::tryCatchList(expr, classes, parentenv, handlers)
#&gt;  28.                       │       └─base:::tryCatchOne(expr, names, parentenv, handlers[[1L]])
#&gt;  29.                       │         └─base:::doTryCatch(return(expr), name, parentenv, handler)
#&gt;  30.                       ├─base::withCallingHandlers(...)
#&gt;  31.                       ├─base::withVisible(eval(expr, envir, enclos))
#&gt;  32.                       └─base::eval(expr, envir, enclos)
#&gt;  33.                         └─base::eval(expr, envir, enclos)
#&gt;  34.                           ├─base::try(check_cardinality_1_1(d1, a, d2, c))
#&gt;  35.                           │ └─base::tryCatch(...)
#&gt;  36.                           │   └─base:::tryCatchList(expr, classes, parentenv, handlers)
#&gt;  37.                           │     └─base:::tryCatchOne(expr, names, parentenv, handlers[[1L]])
#&gt;  38.                           │       └─base:::doTryCatch(return(expr), name, parentenv, handler)
#&gt;  39.                           └─dm::check_cardinality_1_1(d1, a, d2, c)
#&gt;  40.                             └─base::tryCatch(...)
#&gt;  41.                               └─base:::tryCatchList(expr, classes, parentenv, handlers)
#&gt;  42.                                 └─base:::tryCatchOne(expr, names, parentenv, handlers[[1L]])
#&gt;  43.                                   └─value[[3L]](cond)
#&gt;  44.                                     └─dm:::abort_not_bijective(as_label(ct), as_label(fkc))</div><div class='input'>
<span class='co'># This passes:</span>
<span class='fu'>check_cardinality_0_1</span>(<span class='no'>d1</span>, <span class='no'>a</span>, <span class='no'>d3</span>, <span class='no'>c</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tobias Schieferdecker, <a href='http://krlmlr.info'>Kirill Müller</a>, <a href='https://www.energie360.ch'><img src="https://krlmlr.github.io/dm/reference/figures/energie-72.png" height="16"/></a>, <a href='https://www.cynkra.com'><img src="https://krlmlr.github.io/dm/reference/figures/cynkra-72.png" height="16"/></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


