<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Flatten part of a <code>dm</code> into a wide table — cdm_flatten_to_tbl • dm</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Flatten part of a <code>dm</code> into a wide table — cdm_flatten_to_tbl" />
<meta property="og:description" content="Gather all information of interest in one place in a wide table (on a database-dm a
temporary table will be created).
If referential integrity is given among the tables of the data model, the resulting
table of this function will contain as many rows as the table start does (exceptions are
join = anti_join (result is empty table with same columns as start) and join = right_join
(number of rows equal to or larger than those of start)).
For more information please refer to vignette(&quot;dm-joining&quot;)." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dm</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.3.9003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/dm.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/dm-class-and-basic-operations.html">Class 'dm' and basic operations</a>
    </li>
    <li>
      <a href="../articles/dm-introduction-relational-data-models.html">Introduction to Relational Data Models</a>
    </li>
    <li>
      <a href="../articles/dm-joining.html">Joining in Relational Data Models</a>
    </li>
    <li>
      <a href="../articles/dm-filtering.html">Filtering in Relational Data Models</a>
    </li>
    <li>
      <a href="../articles/dm-visualization.html">Visualizing 'dm' objects</a>
    </li>
    <li>
      <a href="../articles/dm-low-level.html">Low level operations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/krlmlr/dm">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Flatten part of a <code>dm</code> into a wide table</h1>
    
    <div class="hidden name"><code>cdm_flatten_to_tbl.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Gather all information of interest in one place in a wide table (on a database-<code><a href='dm.html'>dm</a></code> a
temporary table will be created).
If referential integrity is given among the tables of the data model, the resulting
table of this function will contain as many rows as the table <code>start</code> does (exceptions are
<code>join = anti_join</code> (result is empty table with same columns as <code>start</code>) and <code>join = right_join</code>
(number of rows equal to or larger than those of <code>start</code>)).
For more information please refer to <code><a href='../articles/dm-joining.html'>vignette("dm-joining")</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>cdm_flatten_to_tbl</span>(<span class='no'>dm</span>, <span class='no'>start</span>, <span class='no'>...</span>, <span class='kw'>join</span> <span class='kw'>=</span> <span class='no'>left_join</span>)

<span class='fu'>cdm_squash_to_tbl</span>(<span class='no'>dm</span>, <span class='no'>start</span>, <span class='no'>...</span>, <span class='kw'>join</span> <span class='kw'>=</span> <span class='no'>left_join</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dm</th>
      <td><p>A <code><a href='dm.html'>dm</a></code> object</p></td>
    </tr>
    <tr>
      <th>start</th>
      <td><p>Table to start from. From this table all outgoing foreign key relations are
considered to establish a processing order for the joins. An interesting choice could be
for example a fact table in a star schema.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Unquoted table names to include in addition to <code>start</code>. The order of the tables here determines
the order of the joins. If empty, all tables that can be reached are included.
If this includes tables which aren't direct neighbours of <code>start</code>,
it will only work with <code>cdm_squash_to_tbl()</code> (given one of the allowed join-methods).</p></td>
    </tr>
    <tr>
      <th>join</th>
      <td><p>The type of join to be performed, see <code><a href='https://dplyr.tidyverse.org/reference/join.html'>dplyr::join()</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A single table, resulting of consecutively joining
all tables involved to table <code>start</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>With the <code>...</code> left empty, this function joins all the tables of your <code><a href='dm.html'>dm</a></code>
object together, that can be reached from table <code>start</code> in the direction of the foreign
key relations (pointing from child table to parent table), using the foreign key relations to
determine the parameter <code>by</code> for the necessary joins.
The result is one table with unique column names.
Use the <code>...</code> if you want to control which tables should be joined to table <code>start</code>.</p>
<p>How does filtering affect the result?</p>
<p><strong>Case 1</strong>, either no filter conditions are set in the <code>dm</code>, or only in a part unconnected to
table <code>start</code>:
The necessary disambiguations of the column names are performed first. Then all
involved foreign tables are joined to table <code>start</code> successively with the join function given in
parameter <code>join</code>.</p>
<p><strong>Case 2</strong>, filter conditions are set for at least one table connected to <code>start</code>:
Disambiguation is performed initially if necessary. Table <code>start</code> is calculated using <code>tbl(dm, "start")</code>. This implies
that the effect of the filters on this table is taken into account. For <code>right_join</code>, <code>full_join</code> and <code>nest_join</code> an error
is thrown in case filters are set, because the filters won't affect right hand side tables and thus the result will be
incorrect in general (and calculating the effects on all RHS-tables would be time-consuming and is not supported;
if desired call <code><a href='cdm_filter.html'>cdm_apply_filters()</a></code> first to achieve this effect.).
For all other join types filtering only <code>start</code> is enough, since the effect is passed on by the
successive joins.</p>
<p>Mind, that calling <code>cdm_flatten_to_tbl()</code> with <code>join = right_join</code> and no table order determined in the <code>...</code>
would not lead to a well-defined result, if two or more foreign tables are to be joined to <code>start</code>. The resulting
table would depend on the order the tables are listed in the <code>dm</code>. Therefore trying this results
in a warning.</p>
<p>Since <code>join = nest_join()</code> does not make sense in this direction (LHS = child table, RHS = parent table: for valid key constraints
each nested column entry would be a tibble of 1 row), an error is thrown, if this method is chosen.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other flattening functions: <code><a href='cdm_join_to_tbl.html'>cdm_join_to_tbl</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='cdm_nycflights13.html'>cdm_nycflights13</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='cdm_select_tbl.html'>cdm_select_tbl</a></span>(-<span class='no'>weather</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'>cdm_flatten_to_tbl</span>(<span class='no'>flights</span>)</div><div class='output co'>#&gt; <span class='message'>Joining, by = c("table", "column")</span></div><div class='output co'>#&gt; <span class='message'>Renamed columns:</span>
#&gt; <span class='message'>* name -&gt; airlines$airlines.name, airports$airports.name</span>
#&gt; <span class='message'>* year -&gt; flights$flights.year, planes$planes.year</span></div><div class='output co'>#&gt; # A tibble: 336,776 x 35
#&gt;    flights.year month   day dep_time sched_dep_time dep_delay arr_time
#&gt;           &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
#&gt;  1         2013     1     1      517            515         2      830
#&gt;  2         2013     1     1      533            529         4      850
#&gt;  3         2013     1     1      542            540         2      923
#&gt;  4         2013     1     1      544            545        -1     1004
#&gt;  5         2013     1     1      554            600        -6      812
#&gt;  6         2013     1     1      554            558        -4      740
#&gt;  7         2013     1     1      555            600        -5      913
#&gt;  8         2013     1     1      557            600        -3      709
#&gt;  9         2013     1     1      557            600        -3      838
#&gt; 10         2013     1     1      558            600        -2      753
#&gt; # … with 336,766 more rows, and 28 more variables: sched_arr_time &lt;int&gt;,
#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
#&gt; #   dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;,
#&gt; #   time_hour &lt;dttm&gt;, airlines.name &lt;chr&gt;, airports.name &lt;chr&gt;, lat &lt;dbl&gt;,
#&gt; #   lon &lt;dbl&gt;, alt &lt;dbl&gt;, tz &lt;dbl&gt;, dst &lt;chr&gt;, tzone &lt;chr&gt;, planes.year &lt;int&gt;,
#&gt; #   type &lt;chr&gt;, manufacturer &lt;chr&gt;, model &lt;chr&gt;, engines &lt;int&gt;, seats &lt;int&gt;,
#&gt; #   speed &lt;int&gt;, engine &lt;chr&gt;</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tobias Schieferdecker, <a href='http://krlmlr.info'>Kirill Müller</a>, <a href='https://www.energie360.ch'><img src="https://krlmlr.github.io/dm/reference/figures/energie-72.png" height="16"/></a>, <a href='https://www.cynkra.com'><img src="https://krlmlr.github.io/dm/reference/figures/cynkra-72.png" height="16"/></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


