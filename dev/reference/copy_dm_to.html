<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Copy data model to data source — copy_dm_to • dm</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Copy data model to data source — copy_dm_to"><meta property="og:description" content="copy_dm_to() takes a dplyr::src_dbi object or a DBI::DBIConnection object as its first argument
and a dm object as its second argument.
The latter is copied to the former.
The default is to create temporary tables, set temporary = FALSE to create permanent tables.
Unless set_key_constraints is FALSE, primary key constraints are set on all databases,
and in addition foreign key constraints are set on MSSQL and Postgres databases."><meta property="og:image" content="https://cynkra.github.io/dm/logo.png"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dm</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.2.4.9003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/dm.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/howto-dm-theory.html">Introduction to relational data models</a>
    </li>
    <li>
      <a href="../articles/howto-dm-df.html">Create a dm object from data frames</a>
    </li>
    <li>
      <a href="../articles/howto-dm-db.html">Create a dm object from a database</a>
    </li>
    <li>
      <a href="../articles/howto-dm-copy.html">Copy data to and from a database</a>
    </li>
    <li>
      <a href="../articles/howto-dm-rows.html">Insert, update or remove rows in a database</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Technical articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tech-dm-join.html">Joining in relational data models</a>
    </li>
    <li>
      <a href="../articles/tech-dm-zoom.html">Zooming and manipulating tables</a>
    </li>
    <li>
      <a href="../articles/tech-dm-filter.html">Filtering in relational data models</a>
    </li>
    <li>
      <a href="../articles/tech-dm-draw.html">Visualizing dm objects</a>
    </li>
    <li>
      <a href="../articles/tech-dm-low-level.html">Model verification - keys, constraints and normalization</a>
    </li>
    <li>
      <a href="../articles/tech-dm-class.html">Class 'dm' and basic operations</a>
    </li>
    <li>
      <a href="../articles/tech-dm-naming.html">Function naming logic</a>
    </li>
    <li>
      <a href="../articles/tech-dm-cdm.html">Migration guide: 'cdm' -&gt; 'dm'</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/cynkra/dm">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Copy data model to data source</h1>
    <small class="dont-index">Source: <a href="https://github.com/cynkra/dm/blob/master/R/db-interface.R"><code>R/db-interface.R</code></a></small>
    <div class="hidden name"><code>copy_dm_to.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>copy_dm_to()</code> takes a <a href="https://dplyr.tidyverse.org/reference/src_dbi.html">dplyr::src_dbi</a> object or a <code><a href="https://dbi.r-dbi.org/reference/DBIConnection-class.html">DBI::DBIConnection</a></code> object as its first argument
and a <code><a href="dm.html">dm</a></code> object as its second argument.
The latter is copied to the former.
The default is to create temporary tables, set <code>temporary = FALSE</code> to create permanent tables.
Unless <code>set_key_constraints</code> is <code>FALSE</code>, primary key constraints are set on all databases,
and in addition foreign key constraints are set on MSSQL and Postgres databases.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class="sourceCode r"><code><span class="fu">copy_dm_to</span><span class="op">(</span>
  <span class="va">dest</span>,
  <span class="va">dm</span>,
  <span class="va">...</span>,
  types <span class="op">=</span> <span class="cn">NULL</span>,
  overwrite <span class="op">=</span> <span class="cn">NULL</span>,
  indexes <span class="op">=</span> <span class="cn">NULL</span>,
  unique_indexes <span class="op">=</span> <span class="cn">NULL</span>,
  set_key_constraints <span class="op">=</span> <span class="cn">TRUE</span>,
  unique_table_names <span class="op">=</span> <span class="cn">NULL</span>,
  table_names <span class="op">=</span> <span class="cn">NULL</span>,
  temporary <span class="op">=</span> <span class="cn">TRUE</span>,
  schema <span class="op">=</span> <span class="cn">NULL</span>,
  progress <span class="op">=</span> <span class="cn">NA</span>,
  copy_to <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>

    <div id="arguments">
    <h2>Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <table class="ref-arguments"><colgroup><col class="name"><col class="desc"></colgroup><tr><th>dest</th>
      <td><p>An object of class <code>"src"</code> or <code>"DBIConnection"</code>.</p></td>
    </tr><tr><th>dm</th>
      <td><p>A <code>dm</code> object.</p></td>
    </tr><tr><th>...</th>
      <td><p>Passed on to <code><a href="https://dplyr.tidyverse.org/reference/copy_to.html">dplyr::copy_to()</a></code> or to the function specified
by the <code>copy_to</code> argument.</p></td>
    </tr><tr><th>overwrite, types, indexes, unique_indexes</th>
      <td><p>Must remain <code>NULL</code>.</p></td>
    </tr><tr><th>set_key_constraints</th>
      <td><p>If <code>TRUE</code> will mirror <code>dm</code> primary and foreign key constraints on a database
and create unique indexes.
Set to <code>FALSE</code> if your data model currently does not satisfy primary or foreign key constraints.</p></td>
    </tr><tr><th>unique_table_names</th>
      <td><p>Deprecated.</p></td>
    </tr><tr><th>table_names</th>
      <td><p>Desired names for the tables on <code>dest</code>; the names within the <code>dm</code> remain unchanged.
Can be <code>NULL</code>, a named character vector, a function or a one-sided formula.</p>
<p>If left <code>NULL</code> (default), the names will be determined automatically depending on the <code>temporary</code> argument:</p><ol><li><p><code>temporary = TRUE</code> (default): unique table names based on the names of the tables in the <code>dm</code> are created.</p></li>
<li><p><code>temporary = FALSE</code>: the table names in the <code>dm</code> are used as names for the tables on <code>dest</code>.</p></li>
</ol><p>If a function or one-sided formula, <code>table_names</code> is converted to a function
using <code><a href="https://rlang.r-lib.org/reference/as_function.html">rlang::as_function()</a></code>.
This function is called with the unquoted table names of the <code>dm</code> object
as the only argument.
The output of this function is processed by <code><a href="https://dbi.r-dbi.org/reference/dbQuoteIdentifier.html">DBI::dbQuoteIdentifier()</a></code>,
that result should be a vector of identifiers of the same length
as the original table names.</p>
<p>Use a variant of
<code>table_names = ~ DBI::SQL(paste0("schema_name", ".", .x))</code>
to specify the same schema for all tables.
Use <code>table_names = identity</code> with <code>temporary = TRUE</code>
to avoid giving temporary tables unique names.</p>
<p>If a named character vector,
the names of this vector need to correspond to the table names in the <code>dm</code>,
and its values are the desired names on <code>dest</code>.
The value is processed by <code><a href="https://dbi.r-dbi.org/reference/dbQuoteIdentifier.html">DBI::dbQuoteIdentifier()</a></code>,
that result should be a vector of identifiers of the same length
as the original table names.</p>
<p>Use qualified names corresponding to your database's syntax
to specify e.g. database and schema for your tables.</p></td>
    </tr><tr><th>temporary</th>
      <td><p>If <code>TRUE</code>, only temporary tables will be created.
These tables will vanish when disconnecting from the database.</p></td>
    </tr><tr><th>schema</th>
      <td><p>Name of schema to copy the <code>dm</code> to.
If <code>schema</code> is provided, an error will be thrown if <code>temporary = FALSE</code> or
<code>table_names</code> is not <code>NULL</code>.</p>
<p>Not all DBMS are supported.</p></td>
    </tr><tr><th>progress</th>
      <td><p>Whether to display a progress bar, if <code>NA</code> (the default)
hide in non-interactive mode, show in interactive mode. Requires the
'progress' package.</p></td>
    </tr><tr><th>copy_to</th>
      <td><p>By default, <code><a href="https://dplyr.tidyverse.org/reference/copy_to.html">dplyr::copy_to()</a></code> is called to upload the
individual tables to the target data source.
This argument allows overriding the standard behavior in cases
when the default does not work as expected, such as spatial data frames
or other tables with special data types.
If not <code>NULL</code>, this argument is processed with <code><a href="https://rlang.r-lib.org/reference/as_function.html">rlang::as_function()</a></code>.</p></td>
    </tr></table></div>

    <div id="value">
    <h2>Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>dm</code> object on the given <code>src</code> with the same table names
as the input <code>dm</code>.</p>
    </div>
    <div id="details">
    <h2>Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>No tables will be overwritten; passing <code>overwrite = TRUE</code> to the function will give an error.
Types are determined separately for each table, setting the <code>types</code> argument will
also throw an error.
The arguments are included in the signature to avoid passing them via the
<code>...</code> ellipsis.</p>
    </div>

    <div id="examples">
    <h2>Examples<a class="anchor" aria-label="anchor" href="#examples"></a></h2>
    <div class="ref-examples sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html">dbConnect</a></span><span class="op">(</span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html">SQLite</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Copy to temporary tables, unique table names by default:</span></span>
<span class="r-in"><span class="va">temp_dm</span> <span class="op">&lt;-</span> <span class="fu">copy_dm_to</span><span class="op">(</span></span>
<span class="r-in">  <span class="va">con</span>,</span>
<span class="r-in">  <span class="fu"><a href="dm_nycflights13.html">dm_nycflights13</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span class="r-in">  set_key_constraints <span class="op">=</span> <span class="cn">FALSE</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Persist, explicitly specify table names:</span></span>
<span class="r-in"><span class="va">persistent_dm</span> <span class="op">&lt;-</span> <span class="fu">copy_dm_to</span><span class="op">(</span></span>
<span class="r-in">  <span class="va">con</span>,</span>
<span class="r-in">  <span class="fu"><a href="dm_nycflights13.html">dm_nycflights13</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span class="r-in">  temporary <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span class="r-in">  table_names <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"flights_"</span>, <span class="va">.x</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="fu">dbplyr</span><span class="fu">::</span><span class="fu"><a href="https://dbplyr.tidyverse.org/reference/remote_name.html">remote_name</a></span><span class="op">(</span><span class="va">persistent_dm</span><span class="op">$</span><span class="va">planes</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;IDENT&gt; `flights_planes`</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html">dbDisconnect</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tobias Schieferdecker, <a href="http://krlmlr.info" class="external-link">Kirill Müller</a>, Darko Bergant, <a href="https://www.energie360.ch/de/" class="external-link"><img src="https://cynkra.github.io/dm/reference/figures/energie-72.png" height="16"></a>, <a href="https://www.cynkra.com" class="external-link"><img src="https://cynkra.github.io/dm/reference/figures/cynkra-72.png" height="16"></a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

